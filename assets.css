const coins = ["btc", "eth", "bonk", "xrp"];
const coinMap = {
  btc: { name: "BTC", avg: 102493.39 },
  eth: { name: "ETH", avg: 2456.12 },
  bonk: { name: "BONK", avg: 0.00000 },
  xrp: { name: "XRP", avg: 2.13 }
};

async function fetchAssets() {
  try {
    const res = await fetch("https://api.binance.com/api/v3/ticker/24hr");
    const data = await res.json();

    const filtered = data.filter(item =>
      coins.includes(item.symbol.replace("USDT", "").toLowerCase())
    );

    const totalPNL = filtered.reduce((acc, coin) => acc + parseFloat(coin.priceChangePercent), 0);
    document.getElementById("total-pnl").innerHTML = `<span class="pnl-green">+0.00 (${(totalPNL / coins.length).toFixed(2)}%)</span>`;

    const assetList = document.getElementById("asset-list");
    assetList.innerHTML = "";

    filtered.forEach(item => {
      const symbol = item.symbol.replace("USDT", "").toLowerCase();
      const coin = coinMap[symbol];
      const price = parseFloat(item.lastPrice);
      const change = parseFloat(item.priceChangePercent);
      const cost = coin.avg;
      const amount = (406783194.24 / coins.length / price).toFixed(6);
      const value = (amount * price).toFixed(2);

      const row = document.createElement("div");
      row.className = "asset-row";

      row.innerHTML = `
        <div class="asset-left">
          <img src="icons/${symbol}.svg" alt="${coin.name}" />
          <div class="asset-info">
            <div class="asset-name">${coin.name}</div>
            <div class="asset-sub">
              $${price.toFixed(5)}<br />
              Today's PNL: $0.00 (${change.toFixed(2)}%)<br />
              Average cost: $${cost.toFixed(2)}
            </div>
          </div>
        </div>
        <div class="asset-right">
          <div class="bold">${amount}</div>
          <div>$${value}</div>
        </div>
      `;

      assetList.appendChild(row);
    });
  } catch (e) {
    console.error("Price fetch failed", e);
  }
}

fetchAssets();
